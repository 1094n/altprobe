# Altprobe
Based on filtering policies, Altprobe extracts a events with high priority (alerts) from the flows generated by security sensors and forwards these alerts to the GrayLog and/or MySQL. Altprobe supports JSON format events via ZeroMQ interface and Unix dtgram socket.

## Installation
Altprobe is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY
<br/>For installation Altprobe on Ubuntu 14.04, please, see file [install](install.md) this github repository.

## Configuration
Examples of configs for Altprobe and sensors can be found in the folder [config](config) this github repository.
Altprobe implements logic  source->filters->destination. Filters can be applied for events, severity of events and for ip address, details see in config file ``/etc/altprobe/altprobe.conf``</br> 

## Usage
Basic altprobe commands:
```
altprobe-start
altprobe-stop
altprobe-restart
altprobe-status
```
NOTE! Do not start, stop or restart of Suricata IDS directly by the suricata command, please, instead, use the scripts commands above.

For example:
```
root@flghost:~# altprobe-status
**********************
* Status of solution *
**********************

altprobe isn't running

nprobe is running with PID 2577

suricata not running!

ossec-monitord is running...
ossec-logcollector is running...
ossec-remoted is running...
ossec-syscheckd is running...
ossec-analysisd is running...
ossec-maild not running...
ossec-execd not running...

root@flghost:~# altprobe-start
altprobe returned 0 as return value
Starting suricata in IDS (af-packet) mode... done.
root@flghost:~# altprobe-status
**********************
* Status of solution *
**********************

altprobe is running with PID file 21611

nprobe is running with PID 2577

suricata is running with PID 21627

ossec-monitord is running...
ossec-logcollector is running...
ossec-remoted is running...
ossec-syscheckd is running...
ossec-analysisd is running...
ossec-maild not running...
ossec-execd not running...
```
  
Check error:
```
cat /var/log/syslog | grep altprobe
```
## Requirements
At this moment altprobe can work with Wazuh HIDS (OSSEC fork) and Suricata NIDS version 2.1 or higher

## Screenshots
Below screenshots of GrayLog forms with events from Altprobe

### Graylog settings for Altprobe:
![](https://github.com/olegzhr/altprobe/blob/master/img/graylog_inputs.jpg)

### IDS statistics for OSSEC and Suricata:
![](https://github.com/olegzhr/altprobe/blob/master/img/ids.jpg)

### Netflow statistics for Ntop nProbe:
![](https://github.com/olegzhr/altprobe/blob/master/img/netflow.jpg)


